#!/bin/sh

nmap -T4 -Pn -n -sS -F -oG tcp.gnmap $1
nmap -T4 -Pn -n -sY -F -oG sctp.gnmap $1
nmap -T4 -Pn -n -p53,69,111,123,137,161,500,514,520 -oG udp.gnmap $1

grep open *.gnmap | awk '{print $2}' | sort | uniq > targets.txt

#create a directory to store script output to keep shellscript folder clean
mkdir $1/

#fast tcp
nmap -T4 -Pn -open -sS -A -oA $1/tcp_fast -iL targets.txt
#full tcp
nmap -T4 -Pn -open -sSVC -A -p- -oA $1/tcp_full -iL targets.txt
#udp scan
nmap -T3 -Pn -open -sU -oA $1/udp -iL targets.txt

#remove left over artifacts
rm targets.txt
